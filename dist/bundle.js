/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _styles_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./styles.css */ \"./src/styles.css\");\n/* harmony import */ var _story_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./story.js */ \"./src/story.js\");\n\n\n\n//# sourceURL=webpack://proyek-awal/./src/index.js?");

/***/ }),

/***/ "./src/models/StoryModel.js":
/*!**********************************!*\
  !*** ./src/models/StoryModel.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _db_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db.js */ \"./src/models/db.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n\nvar StoryModel = /*#__PURE__*/function () {\n  function StoryModel() {\n    var _this = this;\n    _classCallCheck(this, StoryModel);\n    this.token = localStorage.getItem('authToken') || '';\n    this.stories = [];\n    this.isOnline = navigator.onLine;\n\n    // Event listener untuk perubahan status koneksi\n    window.addEventListener('online', function () {\n      _this.isOnline = true;\n      console.log('Anda kembali online');\n    });\n    window.addEventListener('offline', function () {\n      _this.isOnline = false;\n      console.log('Anda sedang offline');\n    });\n  }\n\n  // Helper function untuk handle fetch dengan fallback offline\n  return _createClass(StoryModel, [{\n    key: \"_fetchWithOfflineFallback\",\n    value: function () {\n      var _fetchWithOfflineFallback2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(url, options, storageKey) {\n        var response, data, _data$data, cachedData, cachedTime, now;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              if (this.isOnline) {\n                _context.next = 3;\n                break;\n              }\n              throw new Error('offline');\n            case 3:\n              _context.next = 5;\n              return fetch(url, options);\n            case 5:\n              response = _context.sent;\n              if (response.ok) {\n                _context.next = 8;\n                break;\n              }\n              throw new Error('API request failed');\n            case 8:\n              _context.next = 10;\n              return response.json();\n            case 10:\n              data = _context.sent;\n              if (!(storageKey && !data.error)) {\n                _context.next = 14;\n                break;\n              }\n              _context.next = 14;\n              return (0,_db_js__WEBPACK_IMPORTED_MODULE_0__.saveData)({\n                id: storageKey,\n                data: {\n                  listStory: data.listStory || ((_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.listStory) || null,\n                  detailStory: data.story || null,\n                  timestamp: new Date().toISOString()\n                }\n              });\n            case 14:\n              return _context.abrupt(\"return\", data);\n            case 17:\n              _context.prev = 17;\n              _context.t0 = _context[\"catch\"](0);\n              if (!(_context.t0.message === 'offline' && storageKey)) {\n                _context.next = 30;\n                break;\n              }\n              _context.next = 22;\n              return (0,_db_js__WEBPACK_IMPORTED_MODULE_0__.getDataById)(storageKey);\n            case 22:\n              cachedData = _context.sent;\n              if (!cachedData) {\n                _context.next = 29;\n                break;\n              }\n              // Cek expired cache (misal 24 jam)\n              cachedTime = new Date(cachedData.timestamp);\n              now = new Date();\n              if (!((now - cachedTime) / 1000 / 3600 > 24)) {\n                _context.next = 28;\n                break;\n              }\n              throw new Error('Cached data expired');\n            case 28:\n              return _context.abrupt(\"return\", _objectSpread(_objectSpread({}, cachedData.data), {}, {\n                fromCache: true,\n                message: 'Anda sedang offline. Menampilkan data terakhir yang tersimpan.'\n              }));\n            case 29:\n              throw new Error('No cached data available');\n            case 30:\n              throw _context.t0;\n            case 31:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[0, 17]]);\n      }));\n      function _fetchWithOfflineFallback(_x, _x2, _x3) {\n        return _fetchWithOfflineFallback2.apply(this, arguments);\n      }\n      return _fetchWithOfflineFallback;\n    }()\n  }, {\n    key: \"getOfflineStories\",\n    value: function () {\n      var _getOfflineStories = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var page,\n          size,\n          location,\n          cacheKey,\n          cachedData,\n          _args2 = arguments;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              page = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : 1;\n              size = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : 10;\n              location = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : 0;\n              cacheKey = \"stories-page\".concat(page, \"-size\").concat(size, \"-loc\").concat(location);\n              _context2.next = 6;\n              return (0,_db_js__WEBPACK_IMPORTED_MODULE_0__.getDataById)(cacheKey);\n            case 6:\n              cachedData = _context2.sent;\n              if (!(cachedData && cachedData.data.listStory)) {\n                _context2.next = 9;\n                break;\n              }\n              return _context2.abrupt(\"return\", cachedData.data.listStory.map(function (story) {\n                return _objectSpread(_objectSpread({}, story), {}, {\n                  fromCache: true,\n                  cacheKey: cacheKey\n                });\n              }));\n            case 9:\n              return _context2.abrupt(\"return\", []);\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }));\n      function getOfflineStories() {\n        return _getOfflineStories.apply(this, arguments);\n      }\n      return getOfflineStories;\n    }()\n  }, {\n    key: \"register\",\n    value: function () {\n      var _register = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(name, email, password) {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              return _context3.abrupt(\"return\", this._fetchWithOfflineFallback('https://story-api.dicoding.dev/v1/register', {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                  name: name,\n                  email: email,\n                  password: password\n                })\n              }));\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function register(_x4, _x5, _x6) {\n        return _register.apply(this, arguments);\n      }\n      return register;\n    }()\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(email, password) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return this._fetchWithOfflineFallback('https://story-api.dicoding.dev/v1/login', {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                  email: email,\n                  password: password\n                })\n              });\n            case 2:\n              result = _context4.sent;\n              if (!result.error) {\n                this.token = result.loginResult.token;\n                // Simpan token untuk penggunaan offline\n                localStorage.setItem('authToken', this.token);\n              }\n              return _context4.abrupt(\"return\", result);\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function login(_x7, _x8) {\n        return _login.apply(this, arguments);\n      }\n      return login;\n    }()\n  }, {\n    key: \"addStory\",\n    value: function () {\n      var _addStory = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(description, photo, lat, lon) {\n        var formData, result;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              if (this.isOnline) {\n                _context5.next = 2;\n                break;\n              }\n              return _context5.abrupt(\"return\", {\n                error: true,\n                message: 'Cannot add story while offline. Please connect to the internet.'\n              });\n            case 2:\n              formData = new FormData();\n              formData.append('description', description);\n              formData.append('photo', photo);\n              if (lat && lon) {\n                formData.append('lat', lat);\n                formData.append('lon', lon);\n              }\n              _context5.next = 8;\n              return this._fetchWithOfflineFallback('https://story-api.dicoding.dev/v1/stories', {\n                method: 'POST',\n                headers: {\n                  'Authorization': 'Bearer ' + this.token\n                },\n                body: formData\n              }, 'latestStories' // Simpan juga ke cache setelah menambah cerita baru\n              );\n            case 8:\n              result = _context5.sent;\n              return _context5.abrupt(\"return\", result);\n            case 10:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function addStory(_x9, _x0, _x1, _x10) {\n        return _addStory.apply(this, arguments);\n      }\n      return addStory;\n    }()\n  }, {\n    key: \"getStories\",\n    value: function () {\n      var _getStories = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var page,\n          size,\n          location,\n          cacheKey,\n          cachedList,\n          result,\n          _result$data,\n          _args6 = arguments;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              page = _args6.length > 0 && _args6[0] !== undefined ? _args6[0] : 1;\n              size = _args6.length > 1 && _args6[1] !== undefined ? _args6[1] : 10;\n              location = _args6.length > 2 && _args6[2] !== undefined ? _args6[2] : 0;\n              cacheKey = \"stories-page\".concat(page, \"-size\").concat(size, \"-loc\").concat(location);\n              if (this.isOnline) {\n                _context6.next = 11;\n                break;\n              }\n              console.warn('ðŸ“´ Anda offline. Memuat cerita dari cache melalui getOfflineStories()');\n              _context6.next = 8;\n              return this.getOfflineStories();\n            case 8:\n              cachedList = _context6.sent;\n              this.stories = cachedList;\n              return _context6.abrupt(\"return\", {\n                error: false,\n                listStory: cachedList,\n                fromCache: true,\n                message: 'Anda sedang offline. Menampilkan cerita yang disimpan di cache.'\n              });\n            case 11:\n              _context6.next = 13;\n              return this._fetchWithOfflineFallback(\"https://story-api.dicoding.dev/v1/stories?page=\".concat(page, \"&size=\").concat(size, \"&location=\").concat(location), {\n                headers: {\n                  'Authorization': 'Bearer ' + this.token\n                }\n              }, cacheKey);\n            case 13:\n              result = _context6.sent;\n              if (!result.error) {\n                this.stories = result.listStory || ((_result$data = result.data) === null || _result$data === void 0 ? void 0 : _result$data.listStory) || [];\n              }\n              return _context6.abrupt(\"return\", result);\n            case 16:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function getStories() {\n        return _getStories.apply(this, arguments);\n      }\n      return getStories;\n    }()\n  }, {\n    key: \"getStoryDetail\",\n    value: function () {\n      var _getStoryDetail = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(storyId) {\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              return _context7.abrupt(\"return\", this._fetchWithOfflineFallback(\"https://story-api.dicoding.dev/v1/stories/\".concat(storyId), {\n                headers: {\n                  'Authorization': 'Bearer ' + this.token\n                }\n              }, \"story-\".concat(storyId)));\n            case 1:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this);\n      }));\n      function getStoryDetail(_x11) {\n        return _getStoryDetail.apply(this, arguments);\n      }\n      return getStoryDetail;\n    }()\n  }, {\n    key: \"subscribeToNotification\",\n    value: function () {\n      var _subscribeToNotification = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(subscription) {\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              return _context8.abrupt(\"return\", this._fetchWithOfflineFallback('https://story-api.dicoding.dev/v1/notifications/subscribe', {\n                method: 'POST',\n                headers: {\n                  'Authorization': \"Bearer \".concat(this.token),\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(subscription)\n              }));\n            case 1:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function subscribeToNotification(_x12) {\n        return _subscribeToNotification.apply(this, arguments);\n      }\n      return subscribeToNotification;\n    }()\n  }, {\n    key: \"unsubscribeFromNotification\",\n    value: function () {\n      var _unsubscribeFromNotification = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(subscription) {\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              return _context9.abrupt(\"return\", this._fetchWithOfflineFallback('https://story-api.dicoding.dev/v1/notifications/subscribe', {\n                method: 'DELETE',\n                headers: {\n                  'Authorization': \"Bearer \".concat(this.token),\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                  endpoint: subscription.endpoint\n                })\n              }));\n            case 1:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this);\n      }));\n      function unsubscribeFromNotification(_x13) {\n        return _unsubscribeFromNotification.apply(this, arguments);\n      }\n      return unsubscribeFromNotification;\n    }() // Method untuk sync data ketika kembali online\n  }, {\n    key: \"syncLocalData\",\n    value: function () {\n      var _syncLocalData = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee0() {\n        return _regeneratorRuntime().wrap(function _callee0$(_context0) {\n          while (1) switch (_context0.prev = _context0.next) {\n            case 0:\n              if (this.isOnline) {\n                // Implementasi sync data lokal ke server jika diperlukan\n                console.log('Syncing local data...');\n                // Contoh: bisa menambahkan antrian cerita yang dibuat offline\n              }\n            case 1:\n            case \"end\":\n              return _context0.stop();\n          }\n        }, _callee0, this);\n      }));\n      function syncLocalData() {\n        return _syncLocalData.apply(this, arguments);\n      }\n      return syncLocalData;\n    }()\n  }, {\n    key: \"deleteOneStoryFromCache\",\n    value: function () {\n      var _deleteOneStoryFromCache = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee1(cacheKey, storyId) {\n        var cachedData, beforeLength;\n        return _regeneratorRuntime().wrap(function _callee1$(_context1) {\n          while (1) switch (_context1.prev = _context1.next) {\n            case 0:\n              _context1.prev = 0;\n              if (!(!cacheKey || !storyId)) {\n                _context1.next = 3;\n                break;\n              }\n              throw new Error(\"Cache key dan story ID tidak boleh kosong\");\n            case 3:\n              _context1.next = 5;\n              return (0,_db_js__WEBPACK_IMPORTED_MODULE_0__.getDataById)(cacheKey);\n            case 5:\n              cachedData = _context1.sent;\n              if (!(!cachedData || !cachedData.data || !Array.isArray(cachedData.data.listStory))) {\n                _context1.next = 8;\n                break;\n              }\n              throw new Error(\"Data cache tidak ditemukan atau format tidak valid\");\n            case 8:\n              // Simpan panjang sebelum filter untuk deteksi apakah story ada\n              beforeLength = cachedData.data.listStory.length; // Hapus story dari listStory\n              cachedData.data.listStory = cachedData.data.listStory.filter(function (story) {\n                return story.id !== storyId;\n              });\n\n              // Cek apakah story ditemukan\n              if (!(cachedData.data.listStory.length === beforeLength)) {\n                _context1.next = 12;\n                break;\n              }\n              throw new Error(\"Cerita tidak ditemukan dalam cache\");\n            case 12:\n              _context1.next = 14;\n              return (0,_db_js__WEBPACK_IMPORTED_MODULE_0__.saveData)({\n                id: cacheKey,\n                data: cachedData.data\n              });\n            case 14:\n              console.log(\"Cerita dengan ID \".concat(storyId, \" berhasil dihapus dari cache \\\"\").concat(cacheKey, \"\\\".\"));\n              return _context1.abrupt(\"return\", {\n                success: true,\n                message: \"Cerita berhasil dihapus dari cache.\"\n              });\n            case 18:\n              _context1.prev = 18;\n              _context1.t0 = _context1[\"catch\"](0);\n              console.error(\"Gagal menghapus cerita dari cache:\", _context1.t0);\n              return _context1.abrupt(\"return\", {\n                success: false,\n                message: _context1.t0.message || \"Gagal menghapus cerita dari cache\"\n              });\n            case 22:\n            case \"end\":\n              return _context1.stop();\n          }\n        }, _callee1, null, [[0, 18]]);\n      }));\n      function deleteOneStoryFromCache(_x14, _x15) {\n        return _deleteOneStoryFromCache.apply(this, arguments);\n      }\n      return deleteOneStoryFromCache;\n    }()\n  }, {\n    key: \"deleteOfflineStory\",\n    value: function () {\n      var _deleteOfflineStory = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(cacheKey) {\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.prev = 0;\n              if (cacheKey) {\n                _context10.next = 3;\n                break;\n              }\n              throw new Error(\"Cache key tidak valid\");\n            case 3:\n              _context10.next = 5;\n              return (0,_db_js__WEBPACK_IMPORTED_MODULE_0__.deleteData)(cacheKey);\n            case 5:\n              console.log(\"Cerita offline dengan key \\\"\".concat(cacheKey, \"\\\" telah dihapus.\"));\n              return _context10.abrupt(\"return\", {\n                success: true,\n                message: \"Cerita offline dengan key \\\"\".concat(cacheKey, \"\\\" berhasil dihapus.\")\n              });\n            case 9:\n              _context10.prev = 9;\n              _context10.t0 = _context10[\"catch\"](0);\n              console.error('Gagal menghapus data offline:', _context10.t0);\n              return _context10.abrupt(\"return\", {\n                success: false,\n                message: _context10.t0.message || 'Gagal menghapus data offline.'\n              });\n            case 13:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, null, [[0, 9]]);\n      }));\n      function deleteOfflineStory(_x16) {\n        return _deleteOfflineStory.apply(this, arguments);\n      }\n      return deleteOfflineStory;\n    }()\n  }]);\n}();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StoryModel);\n\n//# sourceURL=webpack://proyek-awal/./src/models/StoryModel.js?");

/***/ }),

/***/ "./src/models/db.js":
/*!**************************!*\
  !*** ./src/models/db.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteData: () => (/* binding */ deleteData),\n/* harmony export */   getAllData: () => (/* binding */ getAllData),\n/* harmony export */   getDataById: () => (/* binding */ getDataById),\n/* harmony export */   openDB: () => (/* binding */ openDB),\n/* harmony export */   saveData: () => (/* binding */ saveData)\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar db;\nvar DB_NAME = 'myDatabase';\nvar DB_VERSION = 1;\nvar STORE_NAME = 'stories';\nfunction openDB() {\n  return _openDB.apply(this, arguments);\n}\nfunction _openDB() {\n  _openDB = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          if (!db) {\n            _context.next = 2;\n            break;\n          }\n          return _context.abrupt(\"return\", db);\n        case 2:\n          return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n            var request = indexedDB.open(DB_NAME, DB_VERSION);\n            request.onupgradeneeded = function (event) {\n              db = event.target.result;\n              if (!db.objectStoreNames.contains(STORE_NAME)) {\n                db.createObjectStore(STORE_NAME, {\n                  keyPath: 'id'\n                });\n              }\n            };\n            request.onsuccess = function (event) {\n              db = event.target.result;\n              resolve(db);\n            };\n            request.onerror = function (event) {\n              reject(\"Gagal membuka database: \".concat(event.target.errorCode));\n            };\n          }));\n        case 3:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _openDB.apply(this, arguments);\n}\nfunction saveData(_x) {\n  return _saveData.apply(this, arguments);\n}\nfunction _saveData() {\n  _saveData = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data) {\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          console.log('Menyimpan data:', data); // Log data sebelum disimpan\n          if (db) {\n            _context2.next = 4;\n            break;\n          }\n          _context2.next = 4;\n          return openDB();\n        case 4:\n          if (!(!data || _typeof(data) !== 'object')) {\n            _context2.next = 6;\n            break;\n          }\n          return _context2.abrupt(\"return\", Promise.reject(\"Data tidak valid: bukan objek\"));\n        case 6:\n          if (data.id) {\n            _context2.next = 9;\n            break;\n          }\n          console.error(\"Data tidak memiliki key 'id'. Data yang diterima:\", data);\n          return _context2.abrupt(\"return\", Promise.reject(\"Data tidak memiliki id yang valid\"));\n        case 9:\n          return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n            var transaction = db.transaction([STORE_NAME], 'readwrite');\n            var store = transaction.objectStore(STORE_NAME);\n            var request = store.put(data);\n            request.onsuccess = function () {\n              return resolve(true);\n            };\n            request.onerror = function (event) {\n              console.error(\"Gagal menyimpan data ke IndexedDB:\", event.target.error);\n              reject(\"Gagal menyimpan data: \".concat(event.target.error));\n            };\n          }));\n        case 10:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return _saveData.apply(this, arguments);\n}\nfunction getAllData() {\n  return _getAllData.apply(this, arguments);\n}\nfunction _getAllData() {\n  _getAllData = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          if (db) {\n            _context3.next = 3;\n            break;\n          }\n          _context3.next = 3;\n          return openDB();\n        case 3:\n          return _context3.abrupt(\"return\", new Promise(function (resolve, reject) {\n            var transaction = db.transaction([STORE_NAME], 'readonly');\n            var store = transaction.objectStore(STORE_NAME);\n            var request = store.getAll();\n            request.onsuccess = function () {\n              return resolve(request.result);\n            };\n            request.onerror = function () {\n              return reject('Gagal mengambil data');\n            };\n          }));\n        case 4:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3);\n  }));\n  return _getAllData.apply(this, arguments);\n}\nfunction deleteData(_x2) {\n  return _deleteData.apply(this, arguments);\n}\nfunction _deleteData() {\n  _deleteData = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(id) {\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          if (db) {\n            _context4.next = 3;\n            break;\n          }\n          _context4.next = 3;\n          return openDB();\n        case 3:\n          if (id) {\n            _context4.next = 5;\n            break;\n          }\n          return _context4.abrupt(\"return\", Promise.reject(\"ID tidak valid\"));\n        case 5:\n          return _context4.abrupt(\"return\", new Promise(function (resolve, reject) {\n            var transaction = db.transaction([STORE_NAME], 'readwrite');\n            var store = transaction.objectStore(STORE_NAME);\n            var request = store[\"delete\"](id);\n            request.onsuccess = function () {\n              return resolve(true);\n            };\n            request.onerror = function () {\n              return reject('Gagal menghapus data');\n            };\n          }));\n        case 6:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4);\n  }));\n  return _deleteData.apply(this, arguments);\n}\nfunction getDataById(_x3) {\n  return _getDataById.apply(this, arguments);\n}\nfunction _getDataById() {\n  _getDataById = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(id) {\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) switch (_context5.prev = _context5.next) {\n        case 0:\n          if (db) {\n            _context5.next = 3;\n            break;\n          }\n          _context5.next = 3;\n          return openDB();\n        case 3:\n          if (id) {\n            _context5.next = 5;\n            break;\n          }\n          return _context5.abrupt(\"return\", Promise.reject(\"ID tidak valid\"));\n        case 5:\n          return _context5.abrupt(\"return\", new Promise(function (resolve, reject) {\n            var transaction = db.transaction([STORE_NAME], 'readonly');\n            var store = transaction.objectStore(STORE_NAME);\n            var request = store.get(id);\n            request.onsuccess = function () {\n              if (request.result) {\n                resolve(request.result);\n              } else {\n                reject('Data tidak ditemukan');\n              }\n            };\n            request.onerror = function () {\n              return reject('Gagal mengambil data');\n            };\n          }));\n        case 6:\n        case \"end\":\n          return _context5.stop();\n      }\n    }, _callee5);\n  }));\n  return _getDataById.apply(this, arguments);\n}\n\n//# sourceURL=webpack://proyek-awal/./src/models/db.js?");

/***/ }),

/***/ "./src/presenters/NotificationManager.js":
/*!***********************************************!*\
  !*** ./src/presenters/NotificationManager.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   setupNotificationButtons: () => (/* binding */ setupNotificationButtons)\n/* harmony export */ });\n/* harmony import */ var _models_StoryModel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../models/StoryModel.js */ \"./src/models/StoryModel.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\n// NotificationManager.js\n\nvar VAPID_PUBLIC_KEY = 'BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk';\nfunction urlBase64ToUint8Array(base64String) {\n  var padding = '='.repeat((4 - base64String.length % 4) % 4);\n  var base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\n  var rawData = atob(base64);\n  return new Uint8Array(_toConsumableArray(rawData).map(function (_char) {\n    return _char.charCodeAt(0);\n  }));\n}\nfunction encodeBase64(buffer) {\n  return btoa(String.fromCharCode.apply(null, new Uint8Array(buffer)));\n}\nvar storyModel = new _models_StoryModel_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\nfunction initPushManager(_x) {\n  return _initPushManager.apply(this, arguments);\n}\nfunction _initPushManager() {\n  _initPushManager = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(token) {\n    var registration, subscription, cleanedSubscription, response;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          console.log('initPushManager called');\n          if ('serviceWorker' in navigator) {\n            _context3.next = 5;\n            break;\n          }\n          alert('Service Worker not supported in this browser.');\n          console.error('Service Worker not supported');\n          return _context3.abrupt(\"return\");\n        case 5:\n          _context3.prev = 5;\n          _context3.next = 8;\n          return navigator.serviceWorker.register('./sw.js');\n        case 8:\n          registration = _context3.sent;\n          console.log('Service Worker registered:', registration);\n\n          // Cek apakah sudah ada subscription\n          _context3.next = 12;\n          return registration.pushManager.getSubscription();\n        case 12:\n          subscription = _context3.sent;\n          if (subscription) {\n            _context3.next = 20;\n            break;\n          }\n          _context3.next = 16;\n          return registration.pushManager.subscribe({\n            userVisibleOnly: true,\n            applicationServerKey: urlBase64ToUint8Array(VAPID_PUBLIC_KEY)\n          });\n        case 16:\n          subscription = _context3.sent;\n          console.log('New push subscription:', subscription);\n          _context3.next = 21;\n          break;\n        case 20:\n          console.log('Existing push subscription:', subscription);\n        case 21:\n          cleanedSubscription = {\n            endpoint: subscription.endpoint,\n            keys: {\n              p256dh: encodeBase64(subscription.getKey('p256dh')),\n              auth: encodeBase64(subscription.getKey('auth'))\n            }\n          };\n          storyModel.token = token;\n          _context3.next = 25;\n          return storyModel.subscribeToNotification(cleanedSubscription);\n        case 25:\n          response = _context3.sent;\n          console.log('Subscribed response:', response);\n          alert('Subscribed Successfully!');\n          _context3.next = 34;\n          break;\n        case 30:\n          _context3.prev = 30;\n          _context3.t0 = _context3[\"catch\"](5);\n          console.error('Error during subscribe:', _context3.t0);\n          alert('Subscription failed: ' + _context3.t0.message);\n        case 34:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[5, 30]]);\n  }));\n  return _initPushManager.apply(this, arguments);\n}\nfunction unsubscribePushManager(_x2) {\n  return _unsubscribePushManager.apply(this, arguments);\n}\nfunction _unsubscribePushManager() {\n  _unsubscribePushManager = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(token) {\n    var registration, subscription, cleanedSubscription, response;\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          console.log('unsubscribePushManager called');\n          _context4.prev = 1;\n          _context4.next = 4;\n          return navigator.serviceWorker.ready;\n        case 4:\n          registration = _context4.sent;\n          console.log('Service Worker ready:', registration);\n          _context4.next = 8;\n          return registration.pushManager.getSubscription();\n        case 8:\n          subscription = _context4.sent;\n          if (!subscription) {\n            _context4.next = 22;\n            break;\n          }\n          cleanedSubscription = {\n            endpoint: subscription.endpoint\n          };\n          storyModel.token = token;\n          _context4.next = 14;\n          return storyModel.unsubscribeFromNotification(cleanedSubscription);\n        case 14:\n          response = _context4.sent;\n          console.log('Unsubscribe response:', response);\n          _context4.next = 18;\n          return subscription.unsubscribe();\n        case 18:\n          console.log('Unsubscribed from push service');\n          alert('Unsubscribed Successfully!');\n          _context4.next = 24;\n          break;\n        case 22:\n          alert('No active subscription found.');\n          console.log('No subscription found to unsubscribe.');\n        case 24:\n          _context4.next = 30;\n          break;\n        case 26:\n          _context4.prev = 26;\n          _context4.t0 = _context4[\"catch\"](1);\n          console.error('Error during unsubscribe:', _context4.t0);\n          alert('Unsubscribe failed: ' + _context4.t0.message);\n        case 30:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4, null, [[1, 26]]);\n  }));\n  return _unsubscribePushManager.apply(this, arguments);\n}\nvar subscribeHandler = null;\nvar unsubscribeHandler = null;\nfunction setupNotificationButtons(token) {\n  var subscribeBtn = document.getElementById('subscribeButton');\n  var unsubscribeBtn = document.getElementById('unsubscribeButton');\n  if (!subscribeBtn || !unsubscribeBtn) {\n    console.error('Subscribe or Unsubscribe button not found in DOM.');\n    alert('Subscription buttons missing in page.');\n    return;\n  }\n  if (subscribeHandler) {\n    subscribeBtn.removeEventListener('click', subscribeHandler);\n  }\n  if (unsubscribeHandler) {\n    unsubscribeBtn.removeEventListener('click', unsubscribeHandler);\n  }\n  subscribeHandler = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            console.log('Subscribe button clicked');\n            _context.next = 3;\n            return initPushManager(token);\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    return function subscribeHandler() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  unsubscribeHandler = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            console.log('Unsubscribe button clicked');\n            _context2.next = 3;\n            return unsubscribePushManager(token);\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }));\n    return function unsubscribeHandler() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  subscribeBtn.addEventListener('click', subscribeHandler);\n  unsubscribeBtn.addEventListener('click', unsubscribeHandler);\n}\n\n\n//# sourceURL=webpack://proyek-awal/./src/presenters/NotificationManager.js?");

/***/ }),

/***/ "./src/presenters/StoryPresenter.js":
/*!******************************************!*\
  !*** ./src/presenters/StoryPresenter.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _models_StoryModel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../models/StoryModel.js */ \"./src/models/StoryModel.js\");\n/* harmony import */ var _views_StoryView_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../views/StoryView.js */ \"./src/views/StoryView.js\");\n/* harmony import */ var _NotificationManager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./NotificationManager.js */ \"./src/presenters/NotificationManager.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n\n\n\nvar StoryPresenter = /*#__PURE__*/function () {\n  function StoryPresenter(view, model) {\n    _classCallCheck(this, StoryPresenter);\n    this.view = view;\n    this.model = model;\n    this.view.bindRegister(this.handleRegister.bind(this));\n    this.view.bindLogin(this.handleLogin.bind(this));\n    this.view.bindAddStory(this.handleAddStory.bind(this));\n    this.view.bindLoadStories(this.handleLoadStories.bind(this));\n    this.view.bindTakePhoto();\n    this.view.bindHashChange(this.handleRoute.bind(this));\n    this.view.bindFetchStoryDetail(this.handleFetchStoryDetail.bind(this));\n    this.view.bindDeleteOfflineStory(this.handleDeleteOfflineStory.bind(this));\n    this.view.bindLogout(this.handleLogout.bind(this));\n    this.view.initMap();\n    this.setupOfflineHandling();\n  }\n  return _createClass(StoryPresenter, [{\n    key: \"setupOfflineHandling\",\n    value: function setupOfflineHandling() {\n      var _this = this;\n      // Handler untuk perubahan status koneksi\n      window.addEventListener('online', function () {\n        _this.view.showFeedback('Koneksi internet kembali pulih', 'success');\n        // Coba sync data ketika kembali online\n        _this.handleLoadStories();\n      });\n      window.addEventListener('offline', function () {\n        _this.view.showFeedback('Anda sedang offline. Menampilkan data terakhir yang tersimpan.', 'warning');\n        _this.loadOfflineStories();\n      });\n    }\n  }, {\n    key: \"handleRegister\",\n    value: function () {\n      var _handleRegister = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(name, email, password) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (!(name.trim() === '' || email.trim() === '' || password.length < 8)) {\n                _context.next = 3;\n                break;\n              }\n              this.view.showFeedback('Pastikan semua field diisi dengan benar dan password minimal 8 karakter.', 'error');\n              return _context.abrupt(\"return\");\n            case 3:\n              _context.prev = 3;\n              this.view.showLoading(true);\n              _context.next = 7;\n              return this.model.register(name, email, password);\n            case 7:\n              result = _context.sent;\n              this.view.showFeedback(result.message, !result.error ? 'success' : 'error');\n              _context.next = 14;\n              break;\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](3);\n              this.view.showFeedback(this.getErrorMessage(_context.t0, 'registrasi'), 'error');\n            case 14:\n              _context.prev = 14;\n              this.view.showLoading(false);\n              return _context.finish(14);\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[3, 11, 14, 17]]);\n      }));\n      function handleRegister(_x, _x2, _x3) {\n        return _handleRegister.apply(this, arguments);\n      }\n      return handleRegister;\n    }()\n  }, {\n    key: \"handleLogin\",\n    value: function () {\n      var _handleLogin = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(email, password) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(email.trim() === '' || password.trim() === '')) {\n                _context2.next = 3;\n                break;\n              }\n              this.view.showFeedback('Email dan password tidak boleh kosong.', 'error');\n              return _context2.abrupt(\"return\");\n            case 3:\n              _context2.prev = 3;\n              this.view.showLoading(true);\n              _context2.next = 7;\n              return this.model.login(email, password);\n            case 7:\n              result = _context2.sent;\n              if (!result.error) {\n                this.view.showFeedback(\"Login berhasil! Selamat datang, \".concat(result.loginResult.name), 'success');\n                (0,_NotificationManager_js__WEBPACK_IMPORTED_MODULE_2__.setupNotificationButtons)(result.loginResult.token);\n                window.location.hash = '#stories';\n              } else {\n                this.view.showFeedback('Login gagal: ' + result.message, 'error');\n              }\n              _context2.next = 14;\n              break;\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](3);\n              this.view.showFeedback(this.getErrorMessage(_context2.t0, 'login'), 'error');\n            case 14:\n              _context2.prev = 14;\n              this.view.showLoading(false);\n              return _context2.finish(14);\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this, [[3, 11, 14, 17]]);\n      }));\n      function handleLogin(_x4, _x5) {\n        return _handleLogin.apply(this, arguments);\n      }\n      return handleLogin;\n    }()\n  }, {\n    key: \"handleAddStory\",\n    value: function () {\n      var _handleAddStory = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(description, photo, lat, lon) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!(!lat || !lon)) {\n                _context3.next = 3;\n                break;\n              }\n              this.view.showFeedback('Silakan pilih lokasi di peta.', 'error');\n              return _context3.abrupt(\"return\");\n            case 3:\n              _context3.prev = 3;\n              this.view.showLoading(true);\n              _context3.next = 7;\n              return this.model.addStory(description, photo, lat, lon);\n            case 7:\n              result = _context3.sent;\n              if (result.error) {\n                this.view.showFeedback(result.message, 'error');\n              } else {\n                this.view.showFeedback(result.message, 'success');\n                this.view.resetAddStoryForm();\n                this.handleLoadStories(1, 10, 0);\n              }\n              _context3.next = 14;\n              break;\n            case 11:\n              _context3.prev = 11;\n              _context3.t0 = _context3[\"catch\"](3);\n              this.view.showFeedback(this.getErrorMessage(_context3.t0, 'menambahkan cerita'), 'error');\n            case 14:\n              _context3.prev = 14;\n              this.view.showLoading(false);\n              return _context3.finish(14);\n            case 17:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this, [[3, 11, 14, 17]]);\n      }));\n      function handleAddStory(_x6, _x7, _x8, _x9) {\n        return _handleAddStory.apply(this, arguments);\n      }\n      return handleAddStory;\n    }()\n  }, {\n    key: \"handleLoadStories\",\n    value: function () {\n      var _handleLoadStories = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var page,\n          size,\n          location,\n          result,\n          _args4 = arguments;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              page = _args4.length > 0 && _args4[0] !== undefined ? _args4[0] : 1;\n              size = _args4.length > 1 && _args4[1] !== undefined ? _args4[1] : 10;\n              location = _args4.length > 2 && _args4[2] !== undefined ? _args4[2] : 0;\n              _context4.prev = 3;\n              this.view.showLoading(true);\n              _context4.next = 7;\n              return this.model.getStories(page, size, location);\n            case 7:\n              result = _context4.sent;\n              if (!result.error) {\n                this.view.displayStories(this.model.stories);\n\n                // Tampilkan pesan khusus jika data dari cache\n                if (result.fromCache) {\n                  this.view.showFeedback(result.message, 'warning');\n                }\n              } else {\n                this.view.showFeedback('Gagal memuat cerita: ' + result.message, 'error');\n              }\n              _context4.next = 15;\n              break;\n            case 11:\n              _context4.prev = 11;\n              _context4.t0 = _context4[\"catch\"](3);\n              this.view.showFeedback(this.getErrorMessage(_context4.t0, 'memuat cerita'), 'error');\n              this.view.displayStories([]); // Kosongkan tampilan jika error\n            case 15:\n              _context4.prev = 15;\n              this.view.showLoading(false);\n              return _context4.finish(15);\n            case 18:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this, [[3, 11, 15, 18]]);\n      }));\n      function handleLoadStories() {\n        return _handleLoadStories.apply(this, arguments);\n      }\n      return handleLoadStories;\n    }()\n  }, {\n    key: \"handleRoute\",\n    value: function () {\n      var _handleRoute = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var _this2 = this;\n        var hash, transition;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              hash = window.location.hash;\n              try {\n                transition = document.startViewTransition(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n                  var token;\n                  return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n                    while (1) switch (_context5.prev = _context5.next) {\n                      case 0:\n                        if (!(hash === '#stories' || hash === '#storySection')) {\n                          _context5.next = 13;\n                          break;\n                        }\n                        _context5.next = 3;\n                        return _this2.view.fadeOut(_this2.view.authSection);\n                      case 3:\n                        _this2.view.authSection.style.display = 'none';\n                        _this2.view.storySection.style.display = 'block';\n                        _context5.next = 7;\n                        return _this2.view.fadeIn(_this2.view.storySection);\n                      case 7:\n                        token = localStorage.getItem('authToken');\n                        if (token) {\n                          (0,_NotificationManager_js__WEBPACK_IMPORTED_MODULE_2__.setupNotificationButtons)(token); // âœ… Pasang ulang tombol notifikasi\n                        }\n                        _context5.next = 11;\n                        return _this2.handleLoadStories();\n                      case 11:\n                        _context5.next = 24;\n                        break;\n                      case 13:\n                        if (!(hash === '#logout')) {\n                          _context5.next = 18;\n                          break;\n                        }\n                        _this2.logout(); // logout user\n                        window.location.hash = '#login';\n                        _context5.next = 24;\n                        break;\n                      case 18:\n                        _context5.next = 20;\n                        return _this2.view.fadeOut(_this2.view.storySection);\n                      case 20:\n                        _this2.view.storySection.style.display = 'none';\n                        _this2.view.authSection.style.display = 'block';\n                        _context5.next = 24;\n                        return _this2.view.fadeIn(_this2.view.authSection);\n                      case 24:\n                      case \"end\":\n                        return _context5.stop();\n                    }\n                  }, _callee5);\n                })));\n              } catch (error) {\n                console.error('Navigation error:', error);\n              }\n            case 2:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6);\n      }));\n      function handleRoute() {\n        return _handleRoute.apply(this, arguments);\n      }\n      return handleRoute;\n    }()\n  }, {\n    key: \"handleFetchStoryDetail\",\n    value: function () {\n      var _handleFetchStoryDetail = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(storyId) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.prev = 0;\n              this.view.showLoading(true);\n              _context7.next = 4;\n              return this.model.getStoryDetail(storyId);\n            case 4:\n              result = _context7.sent;\n              if (!result.error) {\n                this.view.showStoryDetail(result.story);\n                // Tampilkan pesan jika data dari cache\n                if (result.fromCache) {\n                  this.view.showFeedback(result.message, 'warning');\n                }\n              } else {\n                this.view.showFeedback('Gagal memuat detail cerita: ' + result.message, 'error');\n              }\n              _context7.next = 11;\n              break;\n            case 8:\n              _context7.prev = 8;\n              _context7.t0 = _context7[\"catch\"](0);\n              this.view.showFeedback(this.getErrorMessage(_context7.t0, 'memuat detail cerita'), 'error');\n            case 11:\n              _context7.prev = 11;\n              this.view.showLoading(false);\n              return _context7.finish(11);\n            case 14:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this, [[0, 8, 11, 14]]);\n      }));\n      function handleFetchStoryDetail(_x0) {\n        return _handleFetchStoryDetail.apply(this, arguments);\n      }\n      return handleFetchStoryDetail;\n    }()\n  }, {\n    key: \"loadOfflineStories\",\n    value: function () {\n      var _loadOfflineStories = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n        var offlineStories;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.prev = 0;\n              _context8.next = 3;\n              return this.model.getOfflineStories();\n            case 3:\n              offlineStories = _context8.sent;\n              this.view.displayStories(offlineStories);\n              this.view.showFeedback('Menampilkan cerita dari cache offline.', 'info');\n              _context8.next = 11;\n              break;\n            case 8:\n              _context8.prev = 8;\n              _context8.t0 = _context8[\"catch\"](0);\n              this.view.showFeedback('Gagal memuat cerita offline: ' + _context8.t0.message, 'error');\n            case 11:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this, [[0, 8]]);\n      }));\n      function loadOfflineStories() {\n        return _loadOfflineStories.apply(this, arguments);\n      }\n      return loadOfflineStories;\n    }()\n  }, {\n    key: \"handleDeleteOfflineStory\",\n    value: function () {\n      var _handleDeleteOfflineStory = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(cacheKey, storyId) {\n        var result, updatedStories;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.prev = 0;\n              _context9.next = 3;\n              return this.model.deleteOneStoryFromCache(cacheKey, storyId);\n            case 3:\n              result = _context9.sent;\n              if (!result.success) {\n                _context9.next = 13;\n                break;\n              }\n              this.view.showFeedback(result.message, 'success');\n              this.view.removeStoryFromDisplay(storyId);\n              _context9.next = 9;\n              return this.model.getOfflineStories();\n            case 9:\n              updatedStories = _context9.sent;\n              this.view.displayStories(updatedStories);\n              _context9.next = 14;\n              break;\n            case 13:\n              this.view.showFeedback(result.message, 'error');\n            case 14:\n              _context9.next = 19;\n              break;\n            case 16:\n              _context9.prev = 16;\n              _context9.t0 = _context9[\"catch\"](0);\n              this.view.showErrorMessage(\"Gagal menghapus cerita offline: \".concat(_context9.t0.message));\n            case 19:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this, [[0, 16]]);\n      }));\n      function handleDeleteOfflineStory(_x1, _x10) {\n        return _handleDeleteOfflineStory.apply(this, arguments);\n      }\n      return handleDeleteOfflineStory;\n    }()\n  }, {\n    key: \"getErrorMessage\",\n    value: function getErrorMessage(error, action) {\n      if (error.message.includes('offline')) {\n        return \"Tidak dapat \".concat(action, \" saat offline. Silakan coba lagi ketika terhubung ke internet.\");\n      }\n      return \"Terjadi kesalahan saat \".concat(action, \": \").concat(error.message);\n    }\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      localStorage.removeItem('token');\n      this.view.showFeedback('Berhasil logout.', 'success');\n      this.view.showAuthSection();\n    }\n  }, {\n    key: \"handleLogout\",\n    value: function handleLogout() {\n      this.logout();\n      window.location.hash = '#login'; // atau hash kosong: ''\n    }\n  }]);\n}();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StoryPresenter);\n\n//# sourceURL=webpack://proyek-awal/./src/presenters/StoryPresenter.js?");

/***/ }),

/***/ "./src/story.js":
/*!**********************!*\
  !*** ./src/story.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _models_StoryModel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./models/StoryModel.js */ \"./src/models/StoryModel.js\");\n/* harmony import */ var _views_StoryView_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./views/StoryView.js */ \"./src/views/StoryView.js\");\n/* harmony import */ var _presenters_StoryPresenter_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./presenters/StoryPresenter.js */ \"./src/presenters/StoryPresenter.js\");\n\n\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  var model = new _models_StoryModel_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\n  var view = new _views_StoryView_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n  var presenter = new _presenters_StoryPresenter_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](view, model);\n  view.setPresenter(presenter);\n  view.showSection('auth');\n  window.view = view;\n  var params = new URLSearchParams(window.location.search);\n  if (params.get('goto') === 'stories') {\n    view.showSection('stories');\n  }\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.register('/Sapa-STORIA/sw.js').then(function (registration) {\n      console.log('Service Worker berhasil didaftarkan:', registration);\n    })[\"catch\"](function (error) {\n      console.error('Service Worker gagal didaftarkan:', error);\n    });\n  }\n});\n\n//# sourceURL=webpack://proyek-awal/./src/story.js?");

/***/ }),

/***/ "./src/styles.css":
/*!************************!*\
  !*** ./src/styles.css ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://proyek-awal/./src/styles.css?");

/***/ }),

/***/ "./src/views/StoryView.js":
/*!********************************!*\
  !*** ./src/views/StoryView.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar StoryView = /*#__PURE__*/function () {\n  function StoryView() {\n    _classCallCheck(this, StoryView);\n    this.registerForm = document.getElementById('registerForm');\n    this.loginForm = document.getElementById('loginForm');\n    this.storyForm = document.getElementById('storyForm');\n    this.storiesDiv = document.getElementById('stories');\n    this.storySection = document.getElementById('storySection');\n    this.authSection = document.getElementById('authSection');\n    this.takePhotoButton = document.getElementById('takePhoto');\n    this.photoInput = document.getElementById('photo');\n    this.video = document.getElementById('video');\n    this.preview = document.getElementById('preview');\n    this.countdownDiv = document.getElementById('countdown');\n    this.retakePhotoButton = document.getElementById('retakePhotoButton');\n    this.loadStoriesButton = document.getElementById('loadStoriesButton');\n    this.offlineIndicator = this.createOfflineIndicator();\n    this.storyContainer = this.storiesDiv;\n    this.feedbackDiv = document.createElement('div');\n    this.feedbackDiv.setAttribute('role', 'alert');\n    this.feedbackDiv.setAttribute('aria-live', 'assertive');\n    document.body.appendChild(this.feedbackDiv);\n    this.map = null;\n    this.latitude = null;\n    this.longitude = null;\n    this.stream = null;\n    this.currentMarkers = [];\n  }\n  return _createClass(StoryView, [{\n    key: \"setPresenter\",\n    value: function setPresenter(presenter) {\n      this.presenter = presenter;\n    }\n  }, {\n    key: \"createOfflineIndicator\",\n    value: function createOfflineIndicator() {\n      var indicator = document.createElement('div');\n      indicator.id = 'offline-indicator';\n      indicator.style.position = 'fixed';\n      indicator.style.bottom = '20px';\n      indicator.style.right = '20px';\n      indicator.style.padding = '10px 15px';\n      indicator.style.backgroundColor = '#ff9800';\n      indicator.style.color = 'white';\n      indicator.style.borderRadius = '4px';\n      indicator.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';\n      indicator.style.zIndex = '1000';\n      indicator.style.display = 'none';\n      indicator.textContent = 'Anda sedang offline';\n      document.body.appendChild(indicator);\n      return indicator;\n    }\n  }, {\n    key: \"updateOnlineStatus\",\n    value: function updateOnlineStatus(online) {\n      if (online) {\n        this.offlineIndicator.style.display = 'none';\n      } else {\n        this.offlineIndicator.style.display = 'block';\n      }\n    }\n  }, {\n    key: \"initMap\",\n    value: function initMap() {\n      var _this = this;\n      this.map = L.map('map').setView([-6.200001, 106.816666], 5);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        maxZoom: 19,\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n      }).addTo(this.map);\n\n      // Tambahkan layer offline\n      L.tileLayer('', {\n        maxZoom: 19,\n        attribution: 'Offline mode'\n      }).addTo(this.map);\n      this.map.on('click', function (e) {\n        _this.latitude = e.latlng.lat;\n        _this.longitude = e.latlng.lng;\n\n        // Hapus marker sebelumnya\n        _this.clearMarkers();\n        var marker = L.marker([_this.latitude, _this.longitude]).addTo(_this.map);\n        _this.currentMarkers.push(marker);\n        marker.bindPopup(\"Titik yang dipilih: Latitude: \".concat(_this.latitude, \", Longitude: \").concat(_this.longitude)).openPopup();\n        _this.showFeedback(\"Koordinat yang dipilih: \".concat(_this.latitude, \", \").concat(_this.longitude), 'info');\n      });\n    }\n  }, {\n    key: \"clearMarkers\",\n    value: function clearMarkers() {\n      var _this2 = this;\n      this.currentMarkers.forEach(function (marker) {\n        return _this2.map.removeLayer(marker);\n      });\n      this.currentMarkers = [];\n    }\n  }, {\n    key: \"showNotificationMessage\",\n    value: function showNotificationMessage(message) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n      var notifBox = document.createElement('div');\n      notifBox.className = \"notification \".concat(type);\n      notifBox.innerText = message;\n\n      // Styling berdasarkan type\n      var styles = {\n        position: 'fixed',\n        top: '20px',\n        right: '20px',\n        padding: '10px 15px',\n        borderRadius: '4px',\n        boxShadow: '0 2px 5px rgba(0,0,0,0.2)',\n        zIndex: '1000',\n        transition: 'opacity 0.5s ease-in-out',\n        color: 'white'\n      };\n      if (type === 'error') {\n        styles.backgroundColor = '#f44336';\n      } else if (type === 'success') {\n        styles.backgroundColor = '#4caf50';\n      } else if (type === 'warning') {\n        styles.backgroundColor = '#ff9800';\n      } else {\n        styles.backgroundColor = '#2196f3';\n      }\n      Object.assign(notifBox.style, styles);\n      document.body.appendChild(notifBox);\n      setTimeout(function () {\n        notifBox.style.opacity = '0';\n        setTimeout(function () {\n          notifBox.remove();\n        }, 500);\n      }, 3000);\n    }\n  }, {\n    key: \"showFeedback\",\n    value: function showFeedback(message) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n      this.showNotificationMessage(message, type);\n      this.feedbackDiv.textContent = message;\n      this.feedbackDiv.className = type;\n    }\n  }, {\n    key: \"showLoading\",\n    value: function showLoading(show) {\n      var loadingElement = document.getElementById('loading') || this.createLoadingElement();\n      loadingElement.style.display = show ? 'block' : 'none';\n    }\n  }, {\n    key: \"createLoadingElement\",\n    value: function createLoadingElement() {\n      var loading = document.createElement('div');\n      loading.id = 'loading';\n      loading.style.position = 'fixed';\n      loading.style.top = '0';\n      loading.style.left = '0';\n      loading.style.width = '100%';\n      loading.style.height = '100%';\n      loading.style.backgroundColor = 'rgba(0,0,0,0.5)';\n      loading.style.display = 'none';\n      loading.style.justifyContent = 'center';\n      loading.style.alignItems = 'center';\n      loading.style.zIndex = '9999';\n      var spinner = document.createElement('div');\n      spinner.className = 'spinner';\n      spinner.style.border = '4px solid rgba(255,255,255,0.3)';\n      spinner.style.borderRadius = '50%';\n      spinner.style.borderTop = '4px solid #fff';\n      spinner.style.width = '40px';\n      spinner.style.height = '40px';\n      spinner.style.animation = 'spin 1s linear infinite';\n      loading.appendChild(spinner);\n      document.body.appendChild(loading);\n      return loading;\n    }\n  }, {\n    key: \"displayStories\",\n    value: function displayStories(stories) {\n      var _this3 = this;\n      this.storiesDiv.innerHTML = '';\n      this.clearMarkers();\n      if (!stories || stories.length === 0) {\n        this.storiesDiv.innerHTML = '<p class=\"no-stories\">Tidak ada cerita yang tersedia</p>';\n        return;\n      }\n      stories.forEach(function (story) {\n        var _story$lat, _story$lon;\n        console.log('Mengecek properti story:', story);\n        var storyElement = document.createElement('div');\n        storyElement.classList.add('story-item');\n        storyElement.dataset.storyId = story.id;\n        var lat = (_story$lat = story.lat) !== null && _story$lat !== void 0 ? _story$lat : null;\n        var lon = (_story$lon = story.lon) !== null && _story$lon !== void 0 ? _story$lon : null;\n        var createdAt = story.createdAt ? new Date(story.createdAt).toLocaleString() : 'Tanggal tidak tersedia';\n        storyElement.innerHTML = \"\\n        <h3>\".concat(_this3.escapeHTML(story.name), \"</h3>\\n        <p>\").concat(_this3.escapeHTML(story.description), \"</p>\\n        \").concat(lat && lon ? \"<p><small>Lokasi: \".concat(lat, \", \").concat(lon, \"</small></p>\") : '', \"\\n        <img src=\\\"\").concat(story.photoUrl, \"\\\" alt=\\\"Gambar cerita oleh \").concat(_this3.escapeHTML(story.name), \"\\\" loading=\\\"lazy\\\">\\n        <p><small>Dibuat pada: \").concat(createdAt, \"</small></p>\\n        \").concat(story.fromCache ? \"\\n          <div class=\\\"cache-badge\\\">Dari Cache</div>\\n          <button class=\\\"delete-offline-btn\\\"\\n                  data-cache-key=\\\"\".concat(story.cacheKey, \"\\\"\\n                  data-story-id=\\\"\").concat(story.id, \"\\\">\\n            Hapus\\n          </button>\\n        \") : '', \"\\n      \");\n        if (story.fromCache) {\n          var deleteBtn = storyElement.querySelector('.delete-offline-btn');\n          if (deleteBtn) {\n            deleteBtn.addEventListener('click', function (e) {\n              e.stopPropagation(); // agar tidak trigger klik pada elemen cerita\n              var cacheKey = deleteBtn.dataset.cacheKey;\n              var storyId = deleteBtn.dataset.storyId;\n              console.log('Presenter di event handler:', _this3.presenter);\n              _this3.presenter.handleDeleteOfflineStory(cacheKey, storyId);\n            });\n          }\n        }\n\n        // Interaksi UI\n        storyElement.addEventListener('mouseenter', function () {\n          storyElement.classList.add('hover-effect');\n        });\n        storyElement.addEventListener('mouseleave', function () {\n          storyElement.classList.remove('hover-effect');\n        });\n        storyElement.querySelector('img').addEventListener('click', function (e) {\n          e.preventDefault();\n          e.stopPropagation();\n        });\n        storyElement.addEventListener('click', function () {\n          _this3.showFeedback(\"Cerita: \".concat(story.name, \" - \").concat(story.description));\n          _this3.showStoryDetail(story);\n          console.log('Detail Story:\\n' + JSON.stringify(story, null, 2));\n          storyElement.classList.add('popup-effect');\n          setTimeout(function () {\n            storyElement.classList.remove('popup-effect');\n          }, 1500);\n        });\n        _this3.storiesDiv.appendChild(storyElement);\n        if (lat && lon) {\n          var marker = L.marker([lat, lon]).addTo(_this3.map);\n          marker.bindPopup(\"<b>\".concat(_this3.escapeHTML(story.name), \"</b><br>\").concat(_this3.escapeHTML(story.description)));\n          _this3.currentMarkers.push(marker);\n        }\n      });\n    }\n  }, {\n    key: \"showStoryDetail\",\n    value: function showStoryDetail(story) {\n      var _story$lat2,\n        _story$lon2,\n        _this4 = this;\n      var modal = document.getElementById('story-modal') || this.createModal();\n      var lat = (_story$lat2 = story.lat) !== null && _story$lat2 !== void 0 ? _story$lat2 : null;\n      var lon = (_story$lon2 = story.lon) !== null && _story$lon2 !== void 0 ? _story$lon2 : null;\n      var createdAt = story.createdAt ? new Date(story.createdAt).toLocaleString() : 'Tanggal tidak tersedia';\n      modal.innerHTML = \"\\n      <div class=\\\"modal-content\\\">\\n        <span class=\\\"close-modal\\\">&times;</span>\\n        <h2>\".concat(this.escapeHTML(story.name), \"</h2>\\n        <img src=\\\"\").concat(story.photoUrl, \"\\\" alt=\\\"Gambar cerita oleh \").concat(this.escapeHTML(story.name), \"\\\">\\n        <p>\").concat(this.escapeHTML(story.description), \"</p>\\n        \").concat(lat && lon ? \"<p><small>Lokasi: \".concat(lat, \", \").concat(lon, \"</small></p>\") : '', \"\\n        <p><small>Dibuat pada: \").concat(createdAt, \"</small></p>\\n        \").concat(story.fromCache ? \"\\n          <div class=\\\"cache-badge\\\">Dari Cache</div>\\n          <button class=\\\"delete-offline-btn\\\"\\n                  data-cache-key=\\\"\".concat(story.cacheKey, \"\\\"\\n                  data-story-id=\\\"\").concat(story.id, \"\\\">\\n            Hapus\\n          </button>\\n        \") : '', \"\\n      </div>\\n    \");\n      modal.style.display = 'block';\n      modal.querySelector('.close-modal').addEventListener('click', function () {\n        modal.style.display = 'none';\n      });\n      window.addEventListener('click', function (e) {\n        if (e.target === modal) modal.style.display = 'none';\n      });\n      if (story.fromCache) {\n        var deleteBtn = modal.querySelector('.delete-offline-btn');\n        if (deleteBtn) {\n          deleteBtn.addEventListener('click', function (e) {\n            e.stopPropagation();\n            var cacheKey = deleteBtn.dataset.cacheKey;\n            var storyId = deleteBtn.dataset.storyId;\n            console.log('Presenter di event handler:', _this4.presenter);\n            _this4.presenter.handleDeleteOfflineStory(cacheKey, storyId);\n            modal.style.display = 'none'; // langsung tutup modal setelah hapus\n          });\n        }\n      }\n    }\n\n    // Tambahkan fungsi helper untuk mencegah XSS\n  }, {\n    key: \"escapeHTML\",\n    value: function escapeHTML(str) {\n      return String(str).replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#039;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n    }\n  }, {\n    key: \"createModal\",\n    value: function createModal() {\n      var modal = document.createElement('div');\n      modal.id = 'story-modal';\n      modal.style.position = 'fixed';\n      modal.style.top = '0';\n      modal.style.left = '0';\n      modal.style.width = '100%';\n      modal.style.height = '100%';\n      modal.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';\n      modal.style.display = 'none';\n      modal.style.justifyContent = 'center';\n      modal.style.alignItems = 'center';\n      modal.style.zIndex = '10000';\n      modal.style.padding = '20px';\n      modal.style.overflowY = 'auto';\n      document.body.appendChild(modal);\n      return modal;\n    }\n  }, {\n    key: \"resetAddStoryForm\",\n    value: function resetAddStoryForm() {\n      this.storyForm.reset();\n      this.preview.src = '';\n      this.preview.style.display = 'none';\n      this.retakePhotoButton.style.display = 'none';\n      this.takePhotoButton.style.display = 'inline-block';\n      this.clearMarkers();\n      this.latitude = null;\n      this.longitude = null;\n    }\n  }, {\n    key: \"deleteOfflineStory\",\n    value: function deleteOfflineStory(cacheKey) {\n      // Contoh menghapus dari localStorage\n      try {\n        localStorage.removeItem(cacheKey); // atau IndexedDB sesuai implementasi\n        this.showFeedback('Cerita offline berhasil dihapus', 'success');\n        this.removeStoryFromDisplay(cacheKey);\n      } catch (error) {\n        this.showFeedback('Gagal menghapus cerita offline', 'error');\n      }\n    }\n  }, {\n    key: \"removeStoryFromDisplay\",\n    value: function removeStoryFromDisplay(cacheKey) {\n      var storyElement = document.querySelector(\"[data-cache-key=\\\"\".concat(cacheKey, \"\\\"]\"));\n      if (storyElement) {\n        storyElement.remove();\n      }\n    }\n  }, {\n    key: \"bindRegister\",\n    value: function bindRegister(handler) {\n      this.registerForm.addEventListener('submit', /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e) {\n          var name, email, password;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                name = document.getElementById('name').value;\n                email = document.getElementById('email').value;\n                password = document.getElementById('password').value;\n                _context.next = 6;\n                return handler(name, email, password);\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }\n  }, {\n    key: \"bindLogin\",\n    value: function bindLogin(handler) {\n      this.loginForm.addEventListener('submit', /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e) {\n          var email, password;\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                e.preventDefault();\n                email = document.getElementById('loginEmail').value;\n                password = document.getElementById('loginPassword').value;\n                _context2.next = 5;\n                return handler(email, password);\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2);\n        }));\n        return function (_x2) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    }\n  }, {\n    key: \"bindLogout\",\n    value: function bindLogout(handler) {\n      var logoutBtn = document.getElementById('logoutButton');\n      if (logoutBtn) {\n        logoutBtn.addEventListener('click', handler); // langsung panggil handleLogout\n      }\n    }\n  }, {\n    key: \"bindAddStory\",\n    value: function bindAddStory(handler) {\n      var _this5 = this;\n      this.storyForm.addEventListener('submit', /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e) {\n          var description, photo;\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                e.preventDefault();\n                description = document.getElementById('description').value;\n                photo = _this5.photoInput.files[0];\n                _context3.next = 5;\n                return handler(description, photo, _this5.latitude, _this5.longitude);\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3);\n        }));\n        return function (_x3) {\n          return _ref3.apply(this, arguments);\n        };\n      }());\n    }\n  }, {\n    key: \"bindLoadStories\",\n    value: function bindLoadStories(handler) {\n      this.loadStoriesButton.addEventListener('click', function () {\n        var page = parseInt(document.getElementById('page').value);\n        var size = parseInt(document.getElementById('size').value);\n        var location = parseInt(document.getElementById('location').value);\n        handler(page, size, location);\n      });\n    }\n  }, {\n    key: \"bindTakePhoto\",\n    value: function bindTakePhoto() {\n      var _this6 = this;\n      this.takePhotoButton.addEventListener('click', /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var countdown, interval;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _this6.takePhotoButton.style.display = 'none';\n              _this6.preview.style.display = 'none';\n              _this6.retakePhotoButton.style.display = 'none';\n              if (_this6.stream) {\n                _context4.next = 10;\n                break;\n              }\n              _context4.next = 6;\n              return navigator.mediaDevices.getUserMedia({\n                video: true\n              });\n            case 6:\n              _this6.stream = _context4.sent;\n              _this6.video.srcObject = _this6.stream;\n              _context4.next = 10;\n              return _this6.video.play();\n            case 10:\n              _this6.video.style.display = 'block';\n              _this6.countdownDiv.style.display = 'block';\n              _this6.countdownDiv.textContent = '3';\n              countdown = 3;\n              interval = setInterval(function () {\n                countdown--;\n                _this6.countdownDiv.textContent = countdown > 0 ? countdown : '';\n                if (countdown === 0) {\n                  clearInterval(interval);\n                  _this6.countdownDiv.style.display = 'none';\n                  _this6.video.style.display = 'none';\n                  var canvas = document.createElement('canvas');\n                  canvas.width = _this6.video.videoWidth;\n                  canvas.height = _this6.video.videoHeight;\n                  var context = canvas.getContext('2d');\n                  context.drawImage(_this6.video, 0, 0, canvas.width, canvas.height);\n                  _this6.preview.src = canvas.toDataURL('image/jpeg');\n                  _this6.preview.style.display = 'block';\n                  canvas.toBlob(function (blob) {\n                    var file = new File([blob], 'photo.jpg', {\n                      type: 'image/jpeg'\n                    });\n                    var dataTransfer = new DataTransfer();\n                    dataTransfer.items.add(file);\n                    _this6.photoInput.files = dataTransfer.files;\n                  });\n                  _this6.stream.getTracks().forEach(function (track) {\n                    return track.stop();\n                  });\n                  _this6.stream = null;\n                  _this6.retakePhotoButton.style.display = 'inline-block';\n                }\n              }, 1000);\n            case 15:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      })));\n      this.retakePhotoButton.addEventListener('click', function () {\n        _this6.preview.style.display = 'none';\n        _this6.retakePhotoButton.style.display = 'none';\n        _this6.takePhotoButton.style.display = 'inline-block';\n      });\n    }\n  }, {\n    key: \"bindHashChange\",\n    value: function bindHashChange(handler) {\n      window.addEventListener('hashchange', function () {\n        handler();\n      });\n      window.addEventListener('DOMContentLoaded', function () {\n        handler();\n      });\n    }\n  }, {\n    key: \"bindFetchStoryDetail\",\n    value: function bindFetchStoryDetail(handler) {\n      this.storiesDiv.addEventListener('click', function (e) {\n        var storyElement = e.target.closest('.story-item');\n        if (storyElement) {\n          var storyId = storyElement.getAttribute('data-story-id');\n          handler(storyId);\n        }\n      });\n    }\n  }, {\n    key: \"bindDeleteStory\",\n    value: function bindDeleteStory(handler) {\n      this.onDeleteCallback = handler;\n    }\n  }, {\n    key: \"bindDeleteOfflineStory\",\n    value: function bindDeleteOfflineStory(callback) {\n      this.storyContainer.addEventListener('click', function (event) {\n        if (event.target.classList.contains('delete-offline-btn')) {\n          var cacheKey = event.target.dataset.cacheKey;\n          callback(cacheKey);\n        }\n      });\n    }\n  }, {\n    key: \"showSection\",\n    value: function showSection(sectionToShow) {\n      var _this7 = this;\n      if (document.startViewTransition) {\n        document.startViewTransition(function () {\n          _this7.authSection.style.display = sectionToShow === 'auth' ? 'block' : 'none';\n          _this7.storySection.style.display = sectionToShow === 'story' ? 'block' : 'none';\n        });\n      } else {\n        this.authSection.style.display = sectionToShow === 'auth' ? 'block' : 'none';\n        this.storySection.style.display = sectionToShow === 'story' ? 'block' : 'none';\n      }\n    }\n  }, {\n    key: \"showAuthSection\",\n    value: function showAuthSection() {\n      if (this.authSection) this.authSection.style.display = 'block';\n      if (this.storySection) this.storySection.style.display = 'none';\n    }\n  }, {\n    key: \"showStorySection\",\n    value: function showStorySection() {\n      if (this.authSection) this.authSection.style.display = 'none';\n      if (this.storySection) this.storySection.style.display = 'block';\n    }\n  }, {\n    key: \"fadeIn\",\n    value: function () {\n      var _fadeIn = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(element) {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              element.style.opacity = 0;\n              element.style.transition = 'opacity 0.5s ease-in';\n              element.style.opacity = 1;\n              _context5.next = 5;\n              return new Promise(function (resolve) {\n                return setTimeout(resolve, 500);\n              });\n            case 5:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5);\n      }));\n      function fadeIn(_x4) {\n        return _fadeIn.apply(this, arguments);\n      }\n      return fadeIn;\n    }()\n  }, {\n    key: \"fadeOut\",\n    value: function () {\n      var _fadeOut = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(element) {\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              element.style.opacity = 1;\n              element.style.transition = 'opacity 0.5s ease-out';\n              element.style.opacity = 0;\n              _context6.next = 5;\n              return new Promise(function (resolve) {\n                return setTimeout(resolve, 500);\n              });\n            case 5:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6);\n      }));\n      function fadeOut(_x5) {\n        return _fadeOut.apply(this, arguments);\n      }\n      return fadeOut;\n    }()\n  }]);\n}();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StoryView);\n\n//# sourceURL=webpack://proyek-awal/./src/views/StoryView.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.js");
/******/ 	
/******/ })()
;